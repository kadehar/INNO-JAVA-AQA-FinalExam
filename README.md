# Промежуточная аттестация

### Задания

Напишите свой тестовый фреймворк, используя знания, полученные в ходе обучения.
Фреймворк должен включать:

- Работу с DB
- Работу с API
- Работу с WEB
- Отчеты Allure

### Реквизиты

- WEB URL: https://www.saucedemo.com/
- API URL: https://x-clients-be.onrender.com
- API Swagger: https://x-clients-be.onrender.com/docs/#/

### Используемые инструменты

В качестве инструментов для выполнения работы использованы следующие библиотеки:

- `Allure Framework` - позволяет создавать отчеты по результатам тестирования
- `Retrofit 2` - декларативный `http`-клиент, позволяющий описать запросы при помощи аннотаций
- `JUnit 5` - фреймворк для запуска тестов
- `Selenide` - удобная обёртка над `Selenium`, позволяющая писать лаконичные `UI`-тесты
- `JDBC` - библиотека `Java` для работы с базами данных
- `Owner` - библиотека по работе с конфигурацией и файлами `properties` в декларативном стиле
- `P6Spy` - популярная библиотека по логированию `SQL`-запросов

`Retrofit 2` выбран из соображений удобства при создании базового класса, позволяющего описывать классы-клиенты, а так же 
из-за наглядного описания запросов с помощью аннотаций.

`Owner` был выбран как один из популярных инструментов по работе с `properties` файлами, что обеспечивает более простую 
интеграцию конфигов в проект.

`Selenide` был выбран из-за своей лаконичности при написании `UI`-тестов, а так же из-за простоты настройки и работы с 
драйвером `Selenium`.

`JDBC` был выбран в качестве самого базового инструмента с наиболее понятным интерфейсом и простоты реализации и настройки.

Сам проект выполнен в разрезе многомодульной архитектуры, где:

- модуль `api` - содержит базовый класс `RestClient` для работы с `http` (в дальнейшем модуль может пополняться и другими полезными классами)
- модуль `db` - содержит класс `Databases` для подключения к БД, а так же логирование запросов и добавление их в `allure`-отчет
- модуль `utils` - содержит вспомогательные классы, такие как генерация тестовых данных или работа с `BigDecimal`


### Создание Allure отчета после прогона тестов и его просмотр

Чтобы создать Allure-отчет после загрузки проекта, нужно выполнить следующий шаг:
`Gradle > verification > allureReport` - установит Allure и все необходимые инструменты 
(можно так же выполнить команду `allureReport` в консоли):

```shell
gradle allureReport
```

`Gradle > verification > allureServe` - Создаст отчет после прогона теста и откроет его в браузере 
(можно выполнить команду `allureServe` в консоли)

```shell
gradle allureServe
```

### Управление браузером

По-умолчанию, браузер в тестах запускается в `headless` режиме.
Чтобы браузер отображался во время тестов необходимо изменить значение `headless` с `true` на `false` в файле `web.properties`.
Там же можно изменить `pageLoadStrategy` и `timeout` для `Selenide`. Для отображения выполнения шагов `Selenide` в отчете нужно изменить значение `enableSteps` с `false` на `true`.

### Запуск тестов

Для запуска тестов могут быть использованы следующие команды:

###### Запуск всех тестов
```shell
gradle test
```

###### Запуск api тестов
```shell
gradle apiTest
```

###### Запуск web тестов
```shell
gradle webTest
```